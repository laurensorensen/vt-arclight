# Overview of the data
## data sources
### items_only.csv
This file is a flat list of all items in the data (no series, subseries, etc.) that was generated by combining excel sheets provided by ICJ and remediated using OpenRefine. A copy of it is uploaded to Google Drive.
### aspace_uploader.xlsx
The Excel upload template provided by the ArchivesSpace uploader plugin developers for uploading archival objects.
### bulk_import_template.csv
A .csv version of the Excel template above. Doesn't correctly upload to ArchivesSpace (some field mappings seem to fail) after converting back to excel, so it's not used.
### series/
CSV files for each of the series in the data, after processing using the first three scripts listed below. Not used for uploading because the version of the ArchivesSpace uploader plugin used on our VM doesn't support CSV uploads.
### uploaders/
Excel uploader files for each of the series in the data, manually generated by copy-pasting the data from the series CSV files into the Excel template. This appears to be the only way to preseve whatever "magic" exists in the excel uploader template.
## scripts
### split_by_series.py
Takes a single input file (hardcoded to items_only.csv) and splits it into multiple .csv files, one for each series, using the value in the "dc:type" column. The output files are named after the series and placed in the (hardcoded) `series` directory.
### add_hierarchy.py
Takes a single input file or directory path as its only argument, and operates on all .csv files found. Generates rows in the data for series, subseries, and file-level information with logic specific to the data (e.g. Audio discs get files, but other subseries do not). ArchivesSpace requires some data in these rows that sets the hierarchy, including the "level" and "hierarchy" columns, so we autogenerate it. Overwrites all input files and renames them to *_hierarchy.csv.
### map_aspace_fields.py
Takes a single input file or directory path as its only argument, and operates on all .csv files found. Maps the columns in the data to ArchivesSpace fields and applies some custom logic to populate certain fields. Overwrites all input files and renames them to *_aspace.csv. Also appends a header row to the top of each file and generates a blank row required by ArchivesSpace's uploader.
### csv2xlsx.py
Takes a directory path as its only argument, and operates on all .csv files found. Converts the .csv files to .xlsx files and outputs the .xlsx files to the same directory. Requires the `pandas` and `openpyxl` python libraries to be installed (e.g. `pip install pandas openpyxl`).
