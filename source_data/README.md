# Overview of the data
## data sources
### items_only.csv
This file is a flat list of all items in the data (no series, subseries, etc.) that was generated by combining excel sheets provided by ICJ and remediated using OpenRefine. A copy of it is uploaded to Google Drive.
### aspace_uploader.xlsx
The Excel upload template provided by the ArchivesSpace uploader plugin developers for uploading archival objects.
### bulk_import_template.csv
A .csv version of the Excel template above. Used for its headers, which are prepended to generated CSV data.
### series/
CSV files for each of the series in the data, after processing using the first three scripts listed below. Not used for uploading because the version of the ArchivesSpace uploader plugin used on our VM doesn't support CSV uploads.
### uploaders/
Excel uploader files for each of the series in the data. For unknown reasons, the first row in each of these sheets has to be copy-pasted from the aspace_uploader.xlsx template file â€” even though the row is empty. Otherwise, the upload will fail with errors about being unable to create the top container for each item.
## scripts
### split_by_series.py
Takes a single input file (hardcoded to items_only.csv) and splits it into multiple .csv files, one for each series, using the value in the "dc:type" column. The output files are named after the series and placed in the (hardcoded) `series` directory.
### add_hierarchy.py
Takes a single input file or directory path as its only argument, and operates on all .csv files found. Generates rows in the data for series, subseries, and file-level information with logic specific to the data (e.g. Audio discs get files, but other subseries do not). ArchivesSpace requires some data in these rows that sets the hierarchy, including the "level" and "hierarchy" columns, so we autogenerate it. Overwrites all input files and renames them to *_hierarchy.csv.
### map_aspace_fields.py
Takes a single input file or directory path as its only argument, and operates on all .csv files found. Maps the columns in the data to ArchivesSpace fields and applies some custom logic to populate certain fields. Overwrites all input files and renames them to *_aspace.csv. Also prepends header rows to the top of each file taken from bulk_import_template.csv.
### csv2xlsx.py
Takes a single input file or directory path as its only argument, and operates on all .csv files found. Converts the .csv files to .xlsx files and outputs the .xlsx files to the same directory. Requires the `openpyxl` python library to be installed (e.g. `pip install openpyxl`).
### regenerate_all.sh
Runs the entire data pipeline, starting from the original items_only.csv file. Permanently deletes the series/ and uploaders/ directories and all files in them, then regenerates them from scratch.
